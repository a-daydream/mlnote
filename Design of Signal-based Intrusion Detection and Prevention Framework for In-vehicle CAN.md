# Design of Signal-based Intrusion Detection and Prevention Framework for In-vehicle CAN

## Abstract

* 随着车载网络的日益发展，汽车面临网络攻击的危险，车载网络安全变的非常重要
* CAN总线是现在使用最广泛的车载控制网络标准，根据车用CAN网络基于信号设计的特性我们提出了一种基于信号的入侵检测和预防的框架
* 在通信矩阵文件的帮助下，我们将车用CAN网络分解成一个由很多信号组成的系统，接着我们通过在信号层面检测和监控网络数据和网络状态来识别非法消息和检测网络异常
* 最后完成了基于我们框架的入侵检测和预防系统，并且通过一个简单的CAN网络和CANoe模拟攻击展示它的适用性和有效性

# Introduction

在汽车通过网络获取更加舒适的服务的同时，承受着网络攻击的安全风险。黑客们能够通过网络扰乱车载控制网络，甚至远程控制汽车。2015年Charlie Miller and Chris Valasek成功远程入侵了一辆吉普，他们远程控制了车里的设备甚至包括油门和刹车，严重影响驾驶人安全。2016年百度安全研究人员成功入侵了T-BOX并且劫持了一系列ARM和MCU之间的协议数据，通过篡改传输数据实现对车的控制。车载网络原始的封闭系统设计在汽车逐渐联网的过程中漏洞百出。对车载网络成功的入侵刺激了汽车网络安全的迫切发展。

CAN总线网络是现在应用最广泛的车载控制网络，它连接了大多数车的控制单元使得它成为汽车网络入侵的最终目标。一旦黑客成功入侵了汽车的CAN网络，他可以轻易的干扰甚至控制汽车。

根据车载CAN网络的特点，我们提出了一个基于信号的入侵检测和预防系统，可以有效的识别非法消息和检测网络异常。

# Related Work

目前，CAN总线的安全研究分为三个方向：基于密码学的消息身份验证、基于物理特征的消息身份验证和CAN总线的异常检测。基于密码学的消息加密认证使用密钥生成消息认证码(MAC)来验证消息的完整性和合法性；基于物理特征的消息身份验证利用一些CAN协议的物理特性实现消息验证的目的；CAN总线异常检测通过利用通信网络和数据的特性或者通过使用大数据分析和机器学习监控和探测CAN总线上的网络异常来探测攻击。

### 基于密码学的身份验证

Groza等提出使用一次性身份验证的方式对CAN消息进行签名，保证消息验证的安全性，但是这对ECU（电子控制单元）的计算性能有一定的要求。Nilsson等提出一种通过在四个连续的CAN帧中的CRC（循环冗余验证）位上存储64位消息验证码的混合消息验证码方法。接收者通过统一的方式对四个连续的CAN消息进行身份验证确保身份验证的安全级别，但是这个方法会有延迟确认身份验证的消极影响。Woo等利用模拟远程通过手机app控制汽车的攻击方法证明了CAN网络的脆弱性，并且相应的提出了一个使用截断的32位消息身份验证码的安全机制，通过使用高16位的扩展ID和16位的CRC检验位存储MAC值以便于在不影响CAN网络负荷率的情况下实现消息身份验证。Kurachi等提出了使用监控节点集中对CAN总线消息进行身份验证方法，它占用扩展ID的高12位存储MAC值并且累计反重放攻击的计数值，所以它不会占用总线数据负荷并且可以使用错误帧及时覆盖异常的CAN帧来阻止攻击信息。Schweppe等提出使用基于消息身份验证机制的密钥分配协议及时取代通信密钥来保证通信安全。Radu等提出一个叫Leia轻量级的身份验证协议，它为每个ID消息使用一个单独的通信密钥和新的值来生成消息身份验证码。Pan等提出一个动态密钥生成算法来解决在CAN总线消息验证安全策略中长期使用固定密钥的问题。每次汽车启动的时候使用时间戳生成一个新的通信密钥，这样可以有效的降低密钥管理的复杂度并且提高密钥的安全性

### 基于物理特征的身份验证

Herrewege等通过分析在汽车CAN网络中的消息身份验证协议的要求提出了CAN+协议。通过带外信道传输MAC值能传输额外的身份验证数据在不影响CAN网络数据传输的情况验证消息，但是CAN+协议未被广泛使用，它的作者也没有测试它的抗干扰能力。Murvay等和Choi等通过访问额外设备识别网络中每个ECU传输数据的独特信号特性来验证每个信息的合法性，但是这个方法只能识别非法设备发动的攻击或者超出其自身权限的攻击。

### CAN总线异常检测

Song等提出通过学习CAN消息周期性特性来检测CAN消极间隔时间从而检测总线异常的方法。这种检测方法简单且有效，可以有效的检测DoS攻击和周期性消息攻击。通过分析CAN网络消息队列的特性，Marchettiet等提出在实际网络中建立不同ID消息相邻模型的转换矩阵的方法，它可以在没有错误报警的CAN总线上检测异常消息序列，但是会错过已经发生的报警，并且它的检测率和实际分布和消息的攻击类型十分相关，可能无法保证测量的高检测率。Lee等提出测试节点的响应性能来检测攻击。通过有规律的发送远程帧和计算对应响应帧的响应时间，测试响应性能和节点间的网络拥塞情况判断是否有攻击发生。Seo等提出基于深度学习模型的异常检测方法，使用正常网络消息ID序列来训练模型，并且随机生成消息ID序列进行监督学习使得它具有检测未知攻击的能力。Avatefipour等提出了基于修改过的在CAN流量上的单类支持向量机的新的有效的异常检测模型，使用机器学习来检测CAN消息ID和数据字段的异常。Yu等提出基于信息熵的CAN总线网络消息异常检测。

## BACKGROUND

> 在进入正式介绍之前，我们需要介绍和车载CAN网络相关的只是，并且分析车载CAN网络的通信特性

### CAN Bus

